! debug zebra vxlan
! debug zebra kernel
! debug zebra dplane
! debug zebra rib
! debug bgp neighbor-events
! debug bgp updates
! debug bgp zebra
!
vrf vrf-101
 vni 101
 exit-vrf
!
interface r1-eth0
 ip address 192.168.0.1/24
!
interface loop101 vrf vrf-101
 ip address 10.0.101.1/32
 ipv6 address fd01::1/128
!
router bgp 65000
 bgp router-id 192.168.0.1
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 no bgp ebgp-requires-policy
 neighbor 192.168.0.2 remote-as 65000
 neighbor 192.168.0.2 capability extended-nexthop
 !
 address-family l2vpn evpn
  neighbor 192.168.0.2 activate
  neighbor 192.168.0.2 route-map rmap_r1 in
  advertise-all-vni
 exit-address-family
!
router bgp 65000 vrf vrf-101
 bgp router-id 10.0.101.1
 bgp log-neighbor-changes
 no bgp network import-check
 address-family ipv4 unicast
  network 10.0.101.1/32
 exit-address-family
 address-family ipv6 unicast
  network fd01::1/128
 exit-address-family
 address-family l2vpn evpn
  rd 65000:1
  route-target both 65000:101
  advertise ipv4 unicast
  advertise ipv6 unicast
 exit-address-family
 !
route-map rmap_r1 permit 1
 match evpn vni 101
exit


